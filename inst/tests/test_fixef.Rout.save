
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ### Test of fixef
> ###
> ### (1): general tests
> ### (2): consistency with summary.plm
> ###
> ### see also:
> ###    * test file test_within_intercept.R for consistency checks
> ###      between functions fixef and within_intercept
> ###    * test file test_fixef_comp_lm_plm.R for a comparison of the fixed effects to LSDV models via lm()
> 
> ############# (1): general run tests #############
> library(plm)
> data("Grunfeld", package = "plm")
> 
> # balanced models
> gi  <- plm(inv ~ value + capital, data = Grunfeld, model = "within")
> gt  <- plm(inv ~ value + capital, data = Grunfeld, model = "within", effect = "time")
> gtw <- plm(inv ~ value + capital, data = Grunfeld, model = "within", effect = "twoways")
> 
> 
> f_level             <- fixef(gi, type = "level")
> f_level_robust_mat  <- fixef(gi, type = "level", vcov = vcovHC(gi)) # vcov is matrix
> f_level_robust_func <- fixef(gi, type = "level", vcov = vcovHC)     # vcov is function
> 
> print(attr(f_level,             "se"))
       1        2        3        4        5        6        7        8 
49.70796 24.93832 24.43162 14.07775 14.16543 12.66874 12.84297 13.99315 
       9       10 
12.89189 11.82689 
> print(attr(f_level_robust_func, "se"))
       1        2        3        4        5        6        7        8 
85.97346 40.49648 44.27241 18.56579 28.84028 15.45980 20.71591 17.26171 
       9       10 
21.56692 11.86157 
> 
> print(summary(f_level),             digits = 8)
       Estimate   Std. Error  t-value   Pr(>|t|)    
1   -70.2967175   49.7079588 -1.41419   0.158959    
2   101.9058137   24.9383232  4.08631 6.4852e-05 ***
3  -235.5718410   24.4316165 -9.64209 < 2.22e-16 ***
4   -27.8092946   14.0777538 -1.97541   0.049685 *  
5  -114.6168128   14.1654333 -8.09130 7.1411e-14 ***
6   -23.1612951   12.6687393 -1.82822   0.069101 .  
7   -66.5534735   12.8429734 -5.18209 5.6290e-07 ***
8   -57.5456573   13.9931464 -4.11242 5.8477e-05 ***
9   -87.2222724   12.8918932 -6.76567 1.6345e-10 ***
10   -6.5678435   11.8268910 -0.55533   0.579328    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> print(summary(f_level_robust_func), digits = 8)
       Estimate   Std. Error  t-value   Pr(>|t|)    
1   -70.2967175   85.9734634 -0.81766 0.41458870    
2   101.9058137   40.4964809  2.51641 0.01269214 *  
3  -235.5718410   44.2724091 -5.32096 2.9169e-07 ***
4   -27.8092946   18.5657912 -1.49788 0.13584202    
5  -114.6168128   28.8402827 -3.97419 0.00010058 ***
6   -23.1612951   15.4597951 -1.49816 0.13576805    
7   -66.5534735   20.7159098 -3.21267 0.00154736 ** 
8   -57.5456573   17.2617119 -3.33372 0.00103213 ** 
9   -87.2222724   21.5669197 -4.04426 7.6538e-05 ***
10   -6.5678435   11.8615708 -0.55371 0.58043682    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> f_level_t             <- fixef(gt, type = "level")
> f_level_t_robust_func <- fixef(gt, type = "level", vcov = vcovHC)     # vcov is function
> 
> print(attr(f_level_t,             "se"))
    1935     1936     1937     1938     1939     1940     1941     1942 
31.25408 31.57989 31.87894 31.39361 31.58505 31.63576 31.62813 31.58354 
    1943     1944     1945     1946     1947     1948     1949     1950 
31.67263 31.68469 31.77937 31.87299 32.14450 32.45284 32.75761 32.93717 
    1951     1952     1953     1954 
33.13580 33.73808 34.64354 35.72691 
> print(attr(f_level_t_robust_func, "se"))
    1935     1936     1937     1938     1939     1940     1941     1942 
32.34680 34.18345 35.75038 33.20545 34.20602 34.46783 34.51459 34.60309 
    1943     1944     1945     1946     1947     1948     1949     1950 
35.04938 35.07138 35.52617 36.06382 38.57547 40.71600 42.66511 43.70350 
    1951     1952     1953     1954 
44.51379 48.04058 52.69984 58.48207 
> 
> print(summary(f_level_t),             digits = 8)
       Estimate Std. Error  t-value Pr(>|t|)  
1935 -23.574968  31.254082 -0.75430 0.451666  
1936 -40.787307  31.579889 -1.29156 0.198184  
1937 -58.066240  31.878940 -1.82146 0.070216 .
1938 -52.017730  31.393606 -1.65695 0.099291 .
1939 -79.818004  31.585049 -2.52708 0.012372 *
1940 -54.079700  31.635759 -1.70945 0.089111 .
1941 -26.202078  31.628133 -0.82844 0.408530  
1942 -24.997122  31.583540 -0.79146 0.429729  
1943 -45.376238  31.672627 -1.43266 0.153708  
1944 -45.692318  31.684692 -1.44209 0.151033  
1945 -57.171437  31.779365 -1.79901 0.073711 .
1946 -30.603029  31.872994 -0.96016 0.338279  
1947 -28.821095  32.144500 -0.89661 0.371138  
1948 -27.494440  32.452843 -0.84721 0.398015  
1949 -52.368285  32.757614 -1.59866 0.111670  
1950 -51.929057  32.937171 -1.57661 0.116661  
1951 -35.246908  33.135802 -1.06371 0.288901  
1952 -29.188192  33.738078 -0.86514 0.388126  
1953 -21.125971  34.643537 -0.60981 0.542765  
1954 -35.889838  35.726906 -1.00456 0.316472  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> print(summary(f_level_t_robust_func), digits = 8)
       Estimate Std. Error  t-value Pr(>|t|)  
1935 -23.574968  32.346803 -0.72882 0.467070  
1936 -40.787307  34.183451 -1.19319 0.234383  
1937 -58.066240  35.750385 -1.62421 0.106100  
1938 -52.017730  33.205451 -1.56654 0.118998  
1939 -79.818004  34.206017 -2.33345 0.020742 *
1940 -54.079700  34.467834 -1.56899 0.118426  
1941 -26.202078  34.514590 -0.75916 0.448761  
1942 -24.997122  34.603094 -0.72240 0.470999  
1943 -45.376238  35.049382 -1.29464 0.197122  
1944 -45.692318  35.071383 -1.30284 0.194313  
1945 -57.171437  35.526170 -1.60928 0.109328  
1946 -30.603029  36.063821 -0.84858 0.397255  
1947 -28.821095  38.575472 -0.74714 0.455968  
1948 -27.494440  40.716004 -0.67527 0.500378  
1949 -52.368285  42.665111 -1.22743 0.221283  
1950 -51.929057  43.703498 -1.18821 0.236333  
1951 -35.246908  44.513794 -0.79182 0.429520  
1952 -29.188192  48.040583 -0.60757 0.544245  
1953 -21.125971  52.699844 -0.40087 0.688994  
1954 -35.889838  58.482071 -0.61369 0.540204  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> f_level_d             <- fixef(gtw, type = "level")
> f_level_d_robust_func <- fixef(gtw, type = "level", vcov = vcovHC)     # vcov is function
> 
> print(attr(f_level_d,             "se"))
NULL
> print(attr(f_level_d_robust_func, "se"))
NULL
> 
> print(summary(f_level_d),             digits = 8)
       Estimate
1   -86.9002299
2   120.1540099
3  -222.1310296
4     8.4536121
5   -92.3388251
6    15.9884125
7   -35.4336200
8   -19.4097154
9   -56.6826742
10   39.9368929
> print(summary(f_level_d_robust_func), digits = 8)
       Estimate
1   -86.9002299
2   120.1540099
3  -222.1310296
4     8.4536121
5   -92.3388251
6    15.9884125
7   -35.4336200
8   -19.4097154
9   -56.6826742
10   39.9368929
> 
> # just run tests for type = "dmean" and type = "dfirst"
> fixef(gi, type = "dmean")
        1         2         3         4         5         6         7         8 
 -11.5528  160.6498 -176.8279   30.9346  -55.8729   35.5826   -7.8095    1.1983 
        9        10 
 -28.4783   52.1761 
> fixef(gt, type = "dmean")
     1935      1936      1937      1938      1939      1940      1941      1942 
 17.44753   0.23519 -17.04374 -10.99523 -38.79551 -13.05720  14.82042  16.02538 
     1943      1944      1945      1946      1947      1948      1949      1950 
 -4.35374  -4.66982 -16.14894  10.41947  12.20140  13.52806 -11.34579 -10.90656 
     1951      1952      1953      1954 
  5.77559  11.83431  19.89653   5.13266 
> fixef(gtw, effect = "individual", type = "dmean")
        1         2         3         4         5         6         7         8 
 -54.0639  152.9903 -189.2947   41.2899  -59.5025   48.8247   -2.5973   13.4266 
        9        10 
 -23.8464   72.7732 
> fixef(gtw, effect = "time",       type = "dmean")
    1935     1936     1937     1938     1939     1940     1941     1942 
 47.3275  28.1301   6.6375   8.1011 -22.1428   3.0924  28.5230  26.1877 
    1943     1944     1945     1946     1947     1948     1949     1950 
  4.3499   4.2287  -8.3556  16.1582   7.9352   3.6110 -26.1676 -28.5686 
    1951     1952     1953     1954 
-15.1534 -17.3049 -20.3905 -46.1987 
> fixef(gtw, effect = "twoways",    type = "dmean")
    1-1935     1-1936     1-1937     1-1938     1-1939     1-1940     1-1941 
  -6.73643  -25.93384  -47.42644  -45.96284  -76.20672  -50.97152  -25.54090 
    1-1942     1-1943     1-1944     1-1945     1-1946     1-1947     1-1948 
 -27.87623  -49.71406  -49.83521  -62.41947  -37.90572  -46.12868  -50.45295 
    1-1949     1-1950     1-1951     1-1952     1-1953     1-1954     2-1935 
 -80.23153  -82.63255  -69.21735  -71.36878  -74.45440 -100.26266  200.31781 
    2-1936     2-1937     2-1938     2-1939     2-1940     2-1941     2-1942 
 181.12040  159.62780  161.09140  130.84752  156.08272  181.51334  179.17801 
    2-1943     2-1944     2-1945     2-1946     2-1947     2-1948     2-1949 
 157.34018  157.21903  144.63477  169.14852  160.92556  156.60129  126.82271 
    2-1950     2-1951     2-1952     2-1953     2-1954     3-1935     3-1936 
 124.42169  137.83689  135.68546  132.59984  106.79158 -141.96723 -161.16464 
    3-1937     3-1938     3-1939     3-1940     3-1941     3-1942     3-1943 
-182.65724 -181.19364 -211.43752 -186.20232 -160.77170 -163.10703 -184.94486 
    3-1944     3-1945     3-1946     3-1947     3-1948     3-1949     3-1950 
-185.06601 -197.65027 -173.13652 -181.35948 -185.68375 -215.46233 -217.86335 
    3-1951     3-1952     3-1953     3-1954     4-1935     4-1936     4-1937 
-204.44815 -206.59958 -209.68520 -235.49346   88.61741   69.42000   47.92740 
    4-1938     4-1939     4-1940     4-1941     4-1942     4-1943     4-1944 
  49.39100   19.14712   44.38232   69.81294   67.47762   45.63978   45.51864 
    4-1945     4-1946     4-1947     4-1948     4-1949     4-1950     4-1951 
  32.93437   57.44812   49.22517   44.90089   15.12231   12.72130   26.13650 
    4-1952     4-1953     4-1954     5-1935     5-1936     5-1937     5-1938 
  23.98507   20.89944   -4.90881  -12.17503  -31.37244  -52.86504  -51.40143 
    5-1939     5-1940     5-1941     5-1942     5-1943     5-1944     5-1945 
 -81.64532  -56.41011  -30.97949  -33.31482  -55.15265  -55.27380  -67.85807 
    5-1946     5-1947     5-1948     5-1949     5-1950     5-1951     5-1952 
 -43.34431  -51.56727  -55.89154  -85.67013  -88.07114  -74.65594  -76.80737 
    5-1953     5-1954     6-1935     6-1936     6-1937     6-1938     6-1939 
 -79.89300 -105.70125   96.15221   76.95480   55.46220   56.92580   26.68192 
    6-1940     6-1941     6-1942     6-1943     6-1944     6-1945     6-1946 
  51.91712   77.34774   75.01242   53.17458   53.05344   40.46917   64.98292 
    6-1947     6-1948     6-1949     6-1950     6-1951     6-1952     6-1953 
  56.75997   52.43569   22.65711   20.25610   33.67130   31.51987   28.43424 
    6-1954     7-1935     7-1936     7-1937     7-1938     7-1939     7-1940 
   2.62599   44.73018   25.53277    4.04017    5.50377  -24.74011    0.49509 
    7-1941     7-1942     7-1943     7-1944     7-1945     7-1946     7-1947 
  25.92571   23.59038    1.75255    1.63140  -10.95286   13.56089    5.33793 
    7-1948     7-1949     7-1950     7-1951     7-1952     7-1953     7-1954 
   1.01366  -28.76492  -31.16594  -17.75074  -19.90217  -22.98779  -48.79605 
    8-1935     8-1936     8-1937     8-1938     8-1939     8-1940     8-1941 
  60.75408   41.55667   20.06407   21.52768   -8.71621   16.51900   41.94962 
    8-1942     8-1943     8-1944     8-1945     8-1946     8-1947     8-1948 
  39.61429   17.77646   17.65531    5.07104   29.58480   21.36184   17.03757 
    8-1949     8-1950     8-1951     8-1952     8-1953     8-1954     9-1935 
 -12.74102  -15.14203   -1.72683   -3.87826   -6.96389  -32.77214   23.48112 
    9-1936     9-1937     9-1938     9-1939     9-1940     9-1941     9-1942 
   4.28372  -17.20889  -15.74528  -45.98917  -20.75396    4.67666    2.34133 
    9-1943     9-1944     9-1945     9-1946     9-1947     9-1948     9-1949 
 -19.49650  -19.61765  -32.20192   -7.68816  -15.91112  -20.23539  -50.01398 
    9-1950     9-1951     9-1952     9-1953     9-1954    10-1935    10-1936 
 -52.41499  -38.99979  -41.15122  -44.23684  -70.04510  120.10069  100.90328 
   10-1937    10-1938    10-1939    10-1940    10-1941    10-1942    10-1943 
  79.41068   80.87428   50.63040   75.86560  101.29623   98.96090   77.12307 
   10-1944    10-1945    10-1946    10-1947    10-1948    10-1949    10-1950 
  77.00192   64.41765   88.93140   80.70845   76.38417   46.60559   44.20458 
   10-1951    10-1952    10-1953    10-1954 
  57.61978   55.46835   52.38272   26.57447 
> 
> 
> fixef(gi, type = "dfirst")
        2         3         4         5         6         7         8         9 
 172.2025 -165.2751   42.4874  -44.3201   47.1354    3.7432   12.7511  -16.9256 
       10 
  63.7289 
> fixef(gt, type = "dfirst")
    1936     1937     1938     1939     1940     1941     1942     1943 
-17.2123 -34.4913 -28.4428 -56.2430 -30.5047  -2.6271  -1.4222 -21.8013 
    1944     1945     1946     1947     1948     1949     1950     1951 
-22.1173 -33.5965  -7.0281  -5.2461  -3.9195 -28.7933 -28.3541 -11.6719 
    1952     1953     1954 
 -5.6132   2.4490 -12.3149 
> fixef(gtw, effect = "individual", type = "dfirst")
        2         3         4         5         6         7         8         9 
 207.0542 -135.2308   95.3538   -5.4386  102.8886   51.4666   67.4905   30.2176 
       10 
 126.8371 
> fixef(gtw, effect = "time",       type = "dfirst")
   1936    1937    1938    1939    1940    1941    1942    1943    1944    1945 
-19.197 -40.690 -39.226 -69.470 -44.235 -18.804 -21.140 -42.978 -43.099 -55.683 
   1946    1947    1948    1949    1950    1951    1952    1953    1954 
-31.169 -39.392 -43.717 -73.495 -75.896 -62.481 -64.632 -67.718 -93.526 
> fixef(gtw, effect = "twoways",    type = "dfirst")
    1-1936     1-1937     1-1938     1-1939     1-1940     1-1941     1-1942 
 -19.19741  -40.69001  -39.22640  -69.47029  -44.23508  -18.80446  -21.13979 
    1-1943     1-1944     1-1945     1-1946     1-1947     1-1948     1-1949 
 -42.97762  -43.09877  -55.68304  -31.16928  -39.39224  -43.71651  -73.49510 
    1-1950     1-1951     1-1952     1-1953     1-1954     2-1935     2-1936 
 -75.89611  -62.48091  -64.63234  -67.71797  -93.52622  207.05424  187.85683 
    2-1937     2-1938     2-1939     2-1940     2-1941     2-1942     2-1943 
 166.36423  167.82784  137.58395  162.81916  188.24978  185.91445  164.07662 
    2-1944     2-1945     2-1946     2-1947     2-1948     2-1949     2-1950 
 163.95547  151.37120  175.88496  167.66200  163.33773  133.55914  131.15813 
    2-1951     2-1952     2-1953     2-1954     3-1935     3-1936     3-1937 
 144.57333  142.42190  139.33627  113.52802 -135.23080 -154.42820 -175.92081 
    3-1938     3-1939     3-1940     3-1941     3-1942     3-1943     3-1944 
-174.45720 -204.70109 -179.46588 -154.03526 -156.37059 -178.20842 -178.32957 
    3-1945     3-1946     3-1947     3-1948     3-1949     3-1950     3-1951 
-190.91384 -166.40008 -174.62304 -178.94731 -208.72590 -211.12691 -197.71171 
    3-1952     3-1953     3-1954     4-1935     4-1936     4-1937     4-1938 
-199.86314 -202.94877 -228.75702   95.35384   76.15644   54.66383   56.12744 
    4-1939     4-1940     4-1941     4-1942     4-1943     4-1944     4-1945 
  25.88355   51.11876   76.54938   74.21405   52.37622   52.25507   39.67080 
    4-1946     4-1947     4-1948     4-1949     4-1950     4-1951     4-1952 
  64.18456   55.96160   51.63733   21.85874   19.45773   32.87293   30.72150 
    4-1953     4-1954     5-1935     5-1936     5-1937     5-1938     5-1939 
  27.63588    1.82762   -5.43860  -24.63600  -46.12860  -44.66500  -74.90888 
    5-1940     5-1941     5-1942     5-1943     5-1944     5-1945     5-1946 
 -49.67368  -24.24306  -26.57839  -48.41622  -48.53737  -61.12164  -36.60788 
    5-1947     5-1948     5-1949     5-1950     5-1951     5-1952     5-1953 
 -44.83084  -49.15511  -78.93369  -81.33471  -67.91951  -70.07094  -73.15656 
    5-1954     6-1935     6-1936     6-1937     6-1938     6-1939     6-1940 
 -98.96482  102.88864   83.69124   62.19863   63.66224   33.41835   58.65356 
    6-1941     6-1942     6-1943     6-1944     6-1945     6-1946     6-1947 
  84.08418   81.74885   59.91102   59.78987   47.20560   71.71936   63.49640 
    6-1948     6-1949     6-1950     6-1951     6-1952     6-1953     6-1954 
  59.17213   29.39354   26.99253   40.40773   38.25630   35.17068    9.36242 
    7-1935     7-1936     7-1937     7-1938     7-1939     7-1940     7-1941 
  51.46661   32.26920   10.77660   12.24021  -18.00368    7.23153   32.66215 
    7-1942     7-1943     7-1944     7-1945     7-1946     7-1947     7-1948 
  30.32682    8.48899    8.36784   -4.21643   20.29733   12.07437    7.75010 
    7-1949     7-1950     7-1951     7-1952     7-1953     7-1954     8-1935 
 -22.02849  -24.42950  -11.01430  -13.16573  -16.25136  -42.05961   67.49051 
    8-1936     8-1937     8-1938     8-1939     8-1940     8-1941     8-1942 
  48.29311   26.80051   28.26411   -1.97977   23.25543   48.68605   46.35072 
    8-1943     8-1944     8-1945     8-1946     8-1947     8-1948     8-1949 
  24.51289   24.39174   11.80747   36.32123   28.09827   23.77400   -6.00458 
    8-1950     8-1951     8-1952     8-1953     8-1954     9-1935     9-1936 
  -8.40560    5.00960    2.85817   -0.22745  -26.03571   30.21756   11.02015 
    9-1937     9-1938     9-1939     9-1940     9-1941     9-1942     9-1943 
 -10.47245   -9.00885  -39.25273  -14.01753   11.41309    9.07776  -12.76007 
    9-1944     9-1945     9-1946     9-1947     9-1948     9-1949     9-1950 
 -12.88122  -25.46548   -0.95173   -9.17469  -13.49896  -43.27754  -45.67856 
    9-1951     9-1952     9-1953     9-1954    10-1935    10-1936    10-1937 
 -32.26336  -34.41478  -37.50041  -63.30867  126.83712  107.63972   86.14711 
   10-1938    10-1939    10-1940    10-1941    10-1942    10-1943    10-1944 
  87.61072   57.36683   82.60204  108.03266  105.69733   83.85950   83.73835 
   10-1945    10-1946    10-1947    10-1948    10-1949    10-1950    10-1951 
  71.15408   95.66784   87.44488   83.12061   53.34202   50.94101   64.35621 
   10-1952    10-1953    10-1954 
  62.20478   59.11916   33.31090 
> 
> fixef(gtw, effect = "twoways",    type = "level")
    1-1935     1-1936     1-1937     1-1938     1-1939     1-1940     1-1941 
 -86.90023 -106.09764 -127.59024 -126.12663 -156.37052 -131.13531 -105.70469 
    1-1942     1-1943     1-1944     1-1945     1-1946     1-1947     1-1948 
-108.04002 -129.87785 -129.99900 -142.58327 -118.06951 -126.29247 -130.61674 
    1-1949     1-1950     1-1951     1-1952     1-1953     1-1954     2-1935 
-160.39533 -162.79634 -149.38114 -151.53257 -154.61820 -180.42645  120.15401 
    2-1936     2-1937     2-1938     2-1939     2-1940     2-1941     2-1942 
 100.95660   79.46400   80.92761   50.68372   75.91893  101.34955   99.01422 
    2-1943     2-1944     2-1945     2-1946     2-1947     2-1948     2-1949 
  77.17639   77.05524   64.47097   88.98473   80.76177   76.43750   46.65891 
    2-1950     2-1951     2-1952     2-1953     2-1954     3-1935     3-1936 
  44.25790   57.67310   55.52167   52.43604   26.62779 -222.13103 -241.32843 
    3-1937     3-1938     3-1939     3-1940     3-1941     3-1942     3-1943 
-262.82104 -261.35743 -291.60132 -266.36611 -240.93549 -243.27082 -265.10865 
    3-1944     3-1945     3-1946     3-1947     3-1948     3-1949     3-1950 
-265.22980 -277.81407 -253.30031 -261.52327 -265.84754 -295.62613 -298.02714 
    3-1951     3-1952     3-1953     3-1954     4-1935     4-1936     4-1937 
-284.61194 -286.76337 -289.84900 -315.65725    8.45361  -10.74379  -32.23640 
    4-1938     4-1939     4-1940     4-1941     4-1942     4-1943     4-1944 
 -30.77279  -61.01668  -35.78147  -10.35085  -12.68618  -34.52401  -34.64516 
    4-1945     4-1946     4-1947     4-1948     4-1949     4-1950     4-1951 
 -47.22943  -22.71567  -30.93863  -35.26290  -65.04149  -67.44250  -54.02730 
    4-1952     4-1953     4-1954     5-1935     5-1936     5-1937     5-1938 
 -56.17873  -59.26435  -85.07261  -92.33883 -111.53623 -133.02883 -131.56523 
    5-1939     5-1940     5-1941     5-1942     5-1943     5-1944     5-1945 
-161.80911 -136.57391 -111.14329 -113.47862 -135.31645 -135.43760 -148.02186 
    5-1946     5-1947     5-1948     5-1949     5-1950     5-1951     5-1952 
-123.50811 -131.73107 -136.05534 -165.83392 -168.23494 -154.81974 -156.97117 
    5-1953     5-1954     6-1935     6-1936     6-1937     6-1938     6-1939 
-160.05679 -185.86505   15.98841   -3.20899  -24.70160  -23.23799  -53.48188 
    6-1940     6-1941     6-1942     6-1943     6-1944     6-1945     6-1946 
 -28.24667   -2.81605   -5.15138  -26.98921  -27.11036  -39.69463  -15.18087 
    6-1947     6-1948     6-1949     6-1950     6-1951     6-1952     6-1953 
 -23.40383  -27.72810  -57.50669  -59.90770  -46.49250  -48.64393  -51.72955 
    6-1954     7-1935     7-1936     7-1937     7-1938     7-1939     7-1940 
 -77.53781  -35.43362  -54.63103  -76.12363  -74.66002 -104.90391  -79.66870 
    7-1941     7-1942     7-1943     7-1944     7-1945     7-1946     7-1947 
 -54.23808  -56.57341  -78.41124  -78.53239  -91.11666  -66.60290  -74.82586 
    7-1948     7-1949     7-1950     7-1951     7-1952     7-1953     7-1954 
 -79.15013 -108.92872 -111.32973  -97.91453 -100.06596 -103.15159 -128.95984 
    8-1935     8-1936     8-1937     8-1938     8-1939     8-1940     8-1941 
 -19.40972  -38.60712  -60.09972  -58.63612  -88.88000  -63.64480  -38.21418 
    8-1942     8-1943     8-1944     8-1945     8-1946     8-1947     8-1948 
 -40.54951  -62.38734  -62.50849  -75.09276  -50.57900  -58.80196  -63.12623 
    8-1949     8-1950     8-1951     8-1952     8-1953     8-1954     9-1935 
 -92.90481  -95.30583  -81.89063  -84.04206  -87.12768 -112.93594  -56.68267 
    9-1936     9-1937     9-1938     9-1939     9-1940     9-1941     9-1942 
 -75.88008  -97.37268  -95.90908 -126.15296 -100.91776  -75.48714  -77.82247 
    9-1943     9-1944     9-1945     9-1946     9-1947     9-1948     9-1949 
 -99.66030  -99.78145 -112.36571  -87.85196  -96.07492 -100.39919 -130.17777 
    9-1950     9-1951     9-1952     9-1953     9-1954    10-1935    10-1936 
-132.57879 -119.16359 -121.31501 -124.40064 -150.20890   39.93689   20.73949 
   10-1937    10-1938    10-1939    10-1940    10-1941    10-1942    10-1943 
  -0.75312    0.71049  -29.53340   -4.29819   21.13243   18.79710   -3.04073 
   10-1944    10-1945    10-1946    10-1947    10-1948    10-1949    10-1950 
  -3.16188  -15.74615    8.76761    0.54465   -3.77962  -33.55821  -35.95922 
   10-1951    10-1952    10-1953    10-1954 
 -22.54402  -24.69545  -27.78107  -53.58933 
> 
> ############# (2): consistency with summary.plm #############
> # compare summary.plm to summary.fixef( , type = "dfirst")
> mod_pool <- plm(inv ~ value + capital + factor(firm), data = Grunfeld, model = "pooling")
> sum_mod_pool <- summary(mod_pool)
> f_dfirst <- fixef(gi, type = "dfirst")
> sum_f_dfirst <- summary(f_dfirst)
> 
> if(!isTRUE(all.equal(sum_mod_pool[["coefficients"]][-c(1:3) , "Estimate"], sum_f_dfirst[ , "Estimate"], check.attributes = FALSE)))
+   stop("estimates diverge: summary.plm vs. summary.fixef(..., type = \"dfirst\")")
> 
> if(!isTRUE(all.equal(sum_mod_pool[["coefficients"]][-c(1:3) , "Std. Error"], sum_f_dfirst[ , "Std. Error"], check.attributes = FALSE)))
+   stop("standard errors diverge: summary.plm vs. summary.fixef(..., type = \"dfirst\")")
> 
> if(!isTRUE(all.equal(sum_mod_pool[["coefficients"]][-c(1:3) , "t-value"], sum_f_dfirst[ , "t-value"], check.attributes = FALSE)))
+   stop("t-values diverge: summary.plm vs. summary.fixef(..., type = \"dfirst\")")
> 
> if(!isTRUE(all.equal(sum_mod_pool[["coefficients"]][-c(1:3) , "Pr(>|t|)"], sum_f_dfirst[ , "Pr(>|t|)"], check.attributes = FALSE)))
+   stop("p-values diverge: summary.plm vs. summary.fixef(..., type = \"dfirst\")")
> 
> 
> ###### compare to package lfe:
> ## Standard errors are bootstrapped in lfe
> ##  -> different SE results compared to plm
> ##  -> different SE results for every new call
> #
> # library(lfe)
> # data("Grunfeld", package = "plm")
> # mod_felm <- felm(inv ~ value + capital | firm, data = Grunfeld)
> # summary(mod_felm)
> # 
> # fe_lfe <- getfe(mod_felm, se = TRUE, bN = 50)
> # print(fe_lfe)
> 
> # sum_f_level <- summary(f_level)
> # print(sum_f_level)
> 
> proc.time()
   user  system elapsed 
   1.06    0.15    1.18 
